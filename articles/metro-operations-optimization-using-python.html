<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<!-- Title to be replaced for each article -->
<title>Metro Operations Optimization using Python | Kishna Kushwaha</title>
<meta content="Article Description" name="description"/>
<!-- Fonts -->
<link href="https://fonts.googleapis.com" rel="preconnect"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&amp;display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Fira+Code&amp;display=swap" rel="stylesheet"/>
<!-- Font Awesome -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet"/>
<!-- Highlight.js Theme (VS Code Dark style) -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/atom-one-dark.min.css" rel="stylesheet"/>
<!-- Custom CSS -->
<link href="../css/style.css" rel="stylesheet"/>
<meta content="unlisted" name="visibility"/></head>
<body>
<!-- Navigation -->
<header>
<div class="container nav-container">
<a class="logo" href="../index.html">
<div class="logo-circle"></div>
                Kishna Kushwaha
            </a>
<button aria-label="Toggle navigation" class="mobile-menu-btn">
<i class="fas fa-bars"></i>
</button>
<ul class="nav-links">
<li><a href="../index.html">Home</a></li>
<li><a href="../about.html">About</a></li>
<li><a href="../articles.html">Articles</a></li>
<li><a href="../projects/machine_learning.html">Projects</a></li>
<li><a href="../resources.html">Recommended Resources</a></li>
<li>
<button aria-label="Search" class="search-trigger-btn nav-link-btn" id="search-trigger">
<i class="fas fa-search"></i>
</button>
</li></ul>
</div>
</header>
<main>
<!-- Top Ad Banner -->
<div class="container" style="margin-top:2rem;">
<div class="ad-unit ad-leaderboard">
<span>Advertisement (Leaderboard)</span>
</div>
</div>
<div class="single-article-container">
<!-- Left: Main Content -->
<div class="article-main">
<article class="article-body">
<h1 style="font-size: 2.5rem; line-height: 1.2; font-weight: 800; margin-bottom: 0.5rem; color: #111827;">
                        Metro Operations Optimization using Python</h1>
<div class="article-meta-small" style="margin-bottom: 2rem;">Nov 05, 2025 • 5 min read</div>
<p>Metro Operations Optimization refers to the systematic process of enhancing the efficiency, reliability, and effectiveness of Metro services through various data-driven techniques and operational adjustments. So, if you want to learn how to optimize the operations of a service like Metro using data-driven techniques, this article is for you. In this article, I’ll take you through the task of Metro Operations Optimization using Python.</p>
<h2 class="wp-block-heading">Metro Operations Optimization: Getting Started</h2>
<p>The problem I am working on in this article is my take on a problem statement I found at statso. The dataset contains several files, as follows:</p>
<ul class="wp-block-list">
<li><strong>Agency</strong>: Information about the Delhi Metro Rail Corporation, including name, URL, and contact details.</li>
<li><strong>Calendar</strong>: Service schedules delineating the operation days (weekdays, weekends) and valid dates for these schedules.</li>
<li><strong>Routes</strong>: Details of metro routes, including short and long names, type of route, and descriptions.</li>
<li><strong>Shapes</strong>: Geographical coordinates of routes, providing the precise paths taken by the metro lines.</li>
<li><strong>Stop Times</strong>: Timetables for each trip indicating arrival and departure times at specific stops.</li>
<li><strong>Stops</strong>: Locations of metro stops, including latitude and longitude coordinates.</li>
<li><strong>Trips</strong>: Information linking trips to routes, including details like trip identifiers and associated route IDs.</li>
</ul>
<p><strong>You can download the dataset <a href="../assets/datasets/2787a-dmrc_gtfs.zip" rel="noreferrer noopener" target="_blank">here</a>.</strong></p>
<p>For the task of Metro Operations Optimization, we will aim to identify the key areas where adjustments in train frequencies could significantly improve the service levels, reduce wait times, and alleviate overcrowding.</p>
<h2 class="wp-block-heading">Metro Operations Optimization using Python</h2>
<p>Now, let’s get started with the task of Metro Operations Optimization by importing the necessary Python libraries and the <strong><a href="../assets/datasets/2787a-dmrc_gtfs.zip" rel="noreferrer noopener" target="_blank">datasets</a></strong>:</p>
<pre><code class="language-python">import pandas as pd

# load all the data files
agency = pd.read_csv('agency.txt')
calendar = pd.read_csv('calendar.txt')
routes = pd.read_csv('routes.txt')
shapes = pd.read_csv('shapes.txt')
stop_times = pd.read_csv('stop_times.txt')
stops = pd.read_csv('stops.txt')
trips = pd.read_csv('trips.txt')

# show the first few rows and the structure of each dataframe
data_overviews = {
    "agency": agency.head(),
    "calendar": calendar.head(),
    "routes": routes.head(),
    "shapes": shapes.head(),
    "stop_times": stop_times.head(),
    "stops": stops.head(),
    "trips": trips.head()
}

data_overviews</code></pre>
<pre class="wp-block-preformatted has-small-font-size"><strong>{'agency':   agency_id                   agency_name                      agency_url  \<br/> 0      DMRC  Delhi Metro Rail Corporation  http://www.delhimetrorail.com/   <br/> <br/>   agency_timezone  agency_lang  agency_phone  agency_fare_url  agency_email  <br/> 0    Asia/Kolkata          NaN           NaN              NaN           NaN  ,<br/> 'calendar':   service_id  monday  tuesday  wednesday  thursday  friday  saturday  sunday  \<br/> 0    weekday       1        1          1         1       1         0       0   <br/> 1   saturday       0        0          0         0       0         1       0   <br/> 2     sunday       0        0          0         0       0         0       1   <br/> <br/>    start_date  end_date  <br/> 0    20190101  20251231  <br/> 1    20190101  20251231  <br/> 2    20190101  20251231  ,<br/> 'routes':    route_id  agency_id route_short_name  \<br/> 0        33        NaN           R_SP_R   <br/> 1        31        NaN           G_DD_R   <br/> 2        29        NaN           P_MS_R   <br/> 3        12        NaN             M_JB   <br/> 4        11        NaN             P_MS   <br/> <br/>                                      route_long_name  route_desc  route_type  \<br/> 0  RAPID_Phase 3 (Rapid Metro) to Sector 55-56 (R...         NaN           1   <br/> 1                    GRAY_Dhansa Bus Stand to Dwarka         NaN           1   <br/> 2                     PINK_Shiv Vihar to Majlis Park         NaN           1   <br/> 3        MAGENTA_Janak Puri West to Botanical Garden         NaN           1   <br/> 4                     PINK_Majlis Park to Shiv Vihar         NaN           1   <br/> <br/>    route_url  route_color  route_text_color  route_sort_order  \<br/> 0        NaN          NaN               NaN               NaN   <br/> 1        NaN          NaN               NaN               NaN   <br/> 2        NaN          NaN               NaN               NaN   <br/> 3        NaN          NaN               NaN               NaN   <br/> 4        NaN          NaN               NaN               NaN   <br/> <br/>    continuous_pickup  continuous_drop_off  <br/> 0                NaN                  NaN  <br/> 1                NaN                  NaN  <br/> 2                NaN                  NaN  <br/> 3                NaN                  NaN  <br/> 4                NaN                  NaN  ,<br/> 'shapes':   shape_id  shape_pt_lat  shape_pt_lon  shape_pt_sequence  shape_dist_traveled<br/> 0  shp_1_2     28.615887     77.022461                  1                0.000<br/> 1  shp_1_2     28.616341     77.022499                  2               50.510<br/> 2  shp_1_2     28.617985     77.022453                  3              233.586<br/> 3  shp_1_2     28.618252     77.022453                  4              263.487<br/> 4  shp_1_2     28.618425     77.022438                  5              282.857,<br/> 'stop_times':    trip_id arrival_time departure_time  stop_id  stop_sequence  stop_headsign  \<br/> 0        0     05:28:08       05:28:28       21              0            NaN   <br/> 1        0     05:30:58       05:31:18       20              1            NaN   <br/> 2        0     05:33:28       05:33:48       19              2            NaN   <br/> 3        0     05:35:33       05:35:53       18              3            NaN   <br/> 4        0     05:37:53       05:38:13       17              4            NaN   <br/> <br/>    pickup_type  drop_off_type  shape_dist_traveled  timepoint  \<br/> 0            0              0                0.000          1   <br/> 1            0              0             1202.405          1   <br/> 2            0              0             2480.750          1   <br/> 3            0              0             3314.936          1   <br/> 4            0              0             4300.216          1   <br/> <br/>    continuous_pickup  continuous_drop_off  <br/> 0                NaN                  NaN  <br/> 1                NaN                  NaN  <br/> 2                NaN                  NaN  <br/> 3                NaN                  NaN  <br/> 4                NaN                  NaN  ,<br/> 'stops':    stop_id  stop_code       stop_name  stop_desc   stop_lat   stop_lon<br/> 0        1        NaN  Dilshad Garden        NaN  28.675991  77.321495<br/> 1        2        NaN         Jhilmil        NaN  28.675648  77.312393<br/> 2        3        NaN  Mansrover park        NaN  28.675352  77.301178<br/> 3        4        NaN        Shahdara        NaN  28.673531  77.287270<br/> 4        5        NaN         Welcome        NaN  28.671986  77.277931,<br/> 'trips':    route_id service_id  trip_id  trip_headsign  trip_short_name  direction_id  \<br/> 0         0    weekday        0            NaN              NaN           NaN   <br/> 1         0    weekday        1            NaN              NaN           NaN   <br/> 2         0    weekday       10            NaN              NaN           NaN   <br/> 3         0    weekday      100            NaN              NaN           NaN   <br/> 4         2    weekday     1000            NaN              NaN           NaN   <br/> <br/>    block_id  shape_id  wheelchair_accessible  bikes_allowed  <br/> 0       NaN  shp_1_30                      0              0  <br/> 1       NaN  shp_1_30                      0              0  <br/> 2       NaN  shp_1_30                      0              0  <br/> 3       NaN  shp_1_30                      0              0  <br/> 4       NaN  shp_1_13                      0              0  }</strong></pre>
<p>Let’s start by analyzing the routes and operations of Delhi Metro to understand how it operates. We’ll start by:</p>
<ul class="wp-block-list">
<li>Plotting the geographical routes on a map to visualize the <strong><a href="delhi-metro-network-analysis-using-python.html" target="">network</a></strong>.</li>
<li>Examining the frequency and scheduling of trips across different days of the week.</li>
<li>Analyzing coverage by examining the distribution of stops and their connectivity.</li>
</ul>
<p>I’ll start by plotting the geographical paths of different routes on a map to visualize how the Delhi Metro covers the area:</p>
<pre><code class="language-python">import matplotlib.pyplot as plt
import seaborn as sns

plt.figure(figsize=(10, 8))
sns.scatterplot(x='shape_pt_lon', y='shape_pt_lat', hue='shape_id', data=shapes, palette='viridis', s=10, legend=None)
plt.title('Geographical Paths of Delhi Metro Routes')
plt.xlabel('Longitude')
plt.ylabel('Latitude')
plt.grid(True)
plt.show()</code></pre>
<figure class="wp-block-image aligncenter size-full is-resized"><img alt="Metro Operations Optimization: Geographical Paths of Delhi Metro Routes" class="wp-image-23449" data-attachment-id="23449" data-comments-opened="1" data-image-caption="" data-image-description="" data-image-meta='{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}' data-image-title="delhi-metro-1" data-large-file="https://i0.wp.com/my-ai-portfolio.com/wp-content/uploads/2024/05/delhi-metro-1.png?fit=863%2C701&amp;ssl=1" data-medium-file="https://i0.wp.com/my-ai-portfolio.com/wp-content/uploads/2024/05/delhi-metro-1.png?fit=300%2C244&amp;ssl=1" data-orig-file="https://i0.wp.com/my-ai-portfolio.com/wp-content/uploads/2024/05/delhi-metro-1.png?fit=863%2C701&amp;ssl=1" data-orig-size="863,701" data-permalink="https://my-ai-portfolio.com/2024/05/13/metro-operations-optimization-using-python/delhi-metro-1/" data-recalc-dims="1" decoding="async" height="701" sizes="(max-width: 863px) 100vw, 863px" src="https://i0.wp.com/my-ai-portfolio.com/wp-content/uploads/2024/05/delhi-metro-1.png?resize=863%2C701&amp;ssl=1" srcset="https://i0.wp.com/my-ai-portfolio.com/wp-content/uploads/2024/05/delhi-metro-1.png?w=863&amp;ssl=1 863w, https://i0.wp.com/my-ai-portfolio.com/wp-content/uploads/2024/05/delhi-metro-1.png?resize=300%2C244&amp;ssl=1 300w, https://i0.wp.com/my-ai-portfolio.com/wp-content/uploads/2024/05/delhi-metro-1.png?resize=768%2C624&amp;ssl=1 768w" style="width:730px;height:auto" width="863"/></figure>
<p>The map visualization shows the geographical paths of the Delhi Metro routes. Each line (identified by a unique colour) represents the path of a different route defined in the shapes dataset. This visual helps to understand how the Metro covers the geographical area of Delhi, demonstrating the connectivity and spread of the network.</p>
<p>Next, I will examine the frequency and scheduling of trips across different days of the week by analyzing the calendar and trip data:</p>
<pre><code class="language-python"># merge trips with calendar to include the day of operation information
trips_calendar = pd.merge(trips, calendar, on='service_id', how='left')

# count the number of trips per day of the week
trip_counts = trips_calendar[['monday', 'tuesday', 'wednesday', 'thursday', 'friday', 'saturday', 'sunday']].sum()

# Plotting
plt.figure(figsize=(10, 6))
trip_counts.plot(kind='bar', color='skyblue')
plt.title('Number of Trips per Day of the Week')
plt.xlabel('Day of the Week')
plt.ylabel('Number of Trips')
plt.xticks(rotation=45)
plt.grid(True)
plt.show()</code></pre>
<figure class="wp-block-image aligncenter size-full is-resized"><img alt="Number of Trips per Day of the Week" class="wp-image-23451" data-attachment-id="23451" data-comments-opened="1" data-image-caption="" data-image-description="" data-image-meta='{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}' data-image-title="delhi-metro-2" data-large-file="https://i0.wp.com/my-ai-portfolio.com/wp-content/uploads/2024/05/delhi-metro-2.png?fit=859%2C599&amp;ssl=1" data-medium-file="https://i0.wp.com/my-ai-portfolio.com/wp-content/uploads/2024/05/delhi-metro-2.png?fit=300%2C209&amp;ssl=1" data-orig-file="https://i0.wp.com/my-ai-portfolio.com/wp-content/uploads/2024/05/delhi-metro-2.png?fit=859%2C599&amp;ssl=1" data-orig-size="859,599" data-permalink="https://my-ai-portfolio.com/2024/05/13/metro-operations-optimization-using-python/delhi-metro-2/" data-recalc-dims="1" decoding="async" height="599" sizes="(max-width: 859px) 100vw, 859px" src="https://i0.wp.com/my-ai-portfolio.com/wp-content/uploads/2024/05/delhi-metro-2.png?resize=859%2C599&amp;ssl=1" srcset="https://i0.wp.com/my-ai-portfolio.com/wp-content/uploads/2024/05/delhi-metro-2.png?w=859&amp;ssl=1 859w, https://i0.wp.com/my-ai-portfolio.com/wp-content/uploads/2024/05/delhi-metro-2.png?resize=300%2C209&amp;ssl=1 300w, https://i0.wp.com/my-ai-portfolio.com/wp-content/uploads/2024/05/delhi-metro-2.png?resize=768%2C536&amp;ssl=1 768w" style="width:727px;height:auto" width="859"/></figure>
<p>The bar chart illustrates the number of trips scheduled for each day of the week for the Delhi Metro. As we can see, the number of trips from Monday to Friday is consistent, indicating a stable weekday schedule designed to accommodate regular commuter traffic. In contrast, the trips decrease slightly on Saturday and even more on Sunday, reflecting lower demand or a reduced service schedule on weekends.</p>
<p>This finding suggests that the Delhi Metro strategically scales its operations based on the expected daily ridership, which likely peaks during weekdays due to work and school commutes.</p>
<p>To further analyze the connectivity and effectiveness of the route strategy, I will analyze the distribution and connectivity of stops:</p>
<pre><code class="language-python"># plotting the locations of the stops
plt.figure(figsize=(10, 10))
sns.scatterplot(x='stop_lon', y='stop_lat', data=stops, color='red', s=50, marker='o')
plt.title('Geographical Distribution of Delhi Metro Stops')
plt.xlabel('Longitude')
plt.ylabel('Latitude')
plt.grid(True)
plt.show()</code></pre>
<figure class="wp-block-image aligncenter size-full is-resized"><img alt="Metro Operations Optimization: Geographical Distribution of Delhi Metro Stops" class="wp-image-23453" data-attachment-id="23453" data-comments-opened="1" data-image-caption="" data-image-description="" data-image-meta='{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}' data-image-title="delhi-metro-3" data-large-file="https://i0.wp.com/my-ai-portfolio.com/wp-content/uploads/2024/05/delhi-metro-3.png?fit=863%2C855&amp;ssl=1" data-medium-file="https://i0.wp.com/my-ai-portfolio.com/wp-content/uploads/2024/05/delhi-metro-3.png?fit=300%2C297&amp;ssl=1" data-orig-file="https://i0.wp.com/my-ai-portfolio.com/wp-content/uploads/2024/05/delhi-metro-3.png?fit=863%2C855&amp;ssl=1" data-orig-size="863,855" data-permalink="https://my-ai-portfolio.com/2024/05/13/metro-operations-optimization-using-python/delhi-metro-3/" data-recalc-dims="1" decoding="async" height="855" loading="lazy" sizes="auto, (max-width: 863px) 100vw, 863px" src="https://i0.wp.com/my-ai-portfolio.com/wp-content/uploads/2024/05/delhi-metro-3.png?resize=863%2C855&amp;ssl=1" srcset="https://i0.wp.com/my-ai-portfolio.com/wp-content/uploads/2024/05/delhi-metro-3.png?w=863&amp;ssl=1 863w, https://i0.wp.com/my-ai-portfolio.com/wp-content/uploads/2024/05/delhi-metro-3.png?resize=300%2C297&amp;ssl=1 300w, https://i0.wp.com/my-ai-portfolio.com/wp-content/uploads/2024/05/delhi-metro-3.png?resize=150%2C150&amp;ssl=1 150w, https://i0.wp.com/my-ai-portfolio.com/wp-content/uploads/2024/05/delhi-metro-3.png?resize=768%2C761&amp;ssl=1 768w, https://i0.wp.com/my-ai-portfolio.com/wp-content/uploads/2024/05/delhi-metro-3.png?resize=50%2C50&amp;ssl=1 50w" style="width:720px;height:auto" width="863"/></figure>
<p>The scatter plot above shows the geographical distribution of Delhi Metro stops. Each red dot represents a metro stop, and their distribution across the map illustrates how the stops cover different areas of Delhi.</p>
<p>From the plot, we can see a widespread distribution, suggesting that the Delhi Metro provides good spatial coverage, allowing access to a broad area and facilitating efficient travel across the city.</p>
<p>The stops are fairly evenly spread, but there are denser clusters, which indicates areas with higher transit needs or central hubs that connect multiple lines.</p>
<p>Now, let’s analyze the route complexity. I will analyze how many routes pass through each stop, which can highlight key transfer points and central hubs within the Delhi Metro network:</p>
<pre><code class="language-python"># merge stops with stop_times to link each stop with trips, and then merge with trips to get route information
stops_with_routes = pd.merge(pd.merge(stop_times, trips, on='trip_id'), routes, on='route_id')

# count how many unique routes pass through each stop
stop_route_counts = stops_with_routes.groupby('stop_id')['route_id'].nunique().reset_index()
stop_route_counts = stop_route_counts.rename(columns={'route_id': 'number_of_routes'})

# merge this with stops to get the names and location for plotting
stop_route_counts = pd.merge(stop_route_counts, stops, on='stop_id')

# plot the number of routes per stop
plt.figure(figsize=(10, 10))
sns.scatterplot(x='stop_lon', y='stop_lat', size='number_of_routes', hue='number_of_routes',
                sizes=(50, 500), alpha=0.5, palette='coolwarm', data=stop_route_counts)
plt.title('Number of Routes per Metro Stop in Delhi')
plt.xlabel('Longitude')
plt.ylabel('Latitude')
plt.legend(title='Number of Routes')
plt.grid(True)
plt.show()</code></pre>
<figure class="wp-block-image aligncenter size-full is-resized"><img alt="Number of Routes per Metro Stop in Delhi" class="wp-image-23456" data-attachment-id="23456" data-comments-opened="1" data-image-caption="" data-image-description="" data-image-meta='{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}' data-image-title="delhi-metro-4" data-large-file="https://i0.wp.com/my-ai-portfolio.com/wp-content/uploads/2024/05/delhi-metro-4.png?fit=863%2C855&amp;ssl=1" data-medium-file="https://i0.wp.com/my-ai-portfolio.com/wp-content/uploads/2024/05/delhi-metro-4.png?fit=300%2C297&amp;ssl=1" data-orig-file="https://i0.wp.com/my-ai-portfolio.com/wp-content/uploads/2024/05/delhi-metro-4.png?fit=863%2C855&amp;ssl=1" data-orig-size="863,855" data-permalink="https://my-ai-portfolio.com/2024/05/13/metro-operations-optimization-using-python/delhi-metro-4/" data-recalc-dims="1" decoding="async" height="855" loading="lazy" sizes="auto, (max-width: 863px) 100vw, 863px" src="https://i0.wp.com/my-ai-portfolio.com/wp-content/uploads/2024/05/delhi-metro-4.png?resize=863%2C855&amp;ssl=1" srcset="https://i0.wp.com/my-ai-portfolio.com/wp-content/uploads/2024/05/delhi-metro-4.png?w=863&amp;ssl=1 863w, https://i0.wp.com/my-ai-portfolio.com/wp-content/uploads/2024/05/delhi-metro-4.png?resize=300%2C297&amp;ssl=1 300w, https://i0.wp.com/my-ai-portfolio.com/wp-content/uploads/2024/05/delhi-metro-4.png?resize=150%2C150&amp;ssl=1 150w, https://i0.wp.com/my-ai-portfolio.com/wp-content/uploads/2024/05/delhi-metro-4.png?resize=768%2C761&amp;ssl=1 768w, https://i0.wp.com/my-ai-portfolio.com/wp-content/uploads/2024/05/delhi-metro-4.png?resize=50%2C50&amp;ssl=1 50w" style="width:728px;height:auto" width="863"/></figure>
<p>The scatter plot above represents the number of routes that pass through each Delhi Metro stop. Stops are visualized in different colours and sizes based on the number of routes they connect, providing insights into the complexity of the network at various locations. Key observations are:</p>
<ul class="wp-block-list">
<li><strong>Hubs and Transfer Points</strong>: Larger circles (in warmer colours) indicate stops where multiple routes intersect. These stops serve as major transfer points within the network, facilitating easier cross-city travel for passengers.</li>
<li><strong>Distribution</strong>: Stops with fewer routes, shown in cooler colours and smaller sizes, tend to be more peripheral or on less busy lines. The central areas and more populated zones have stops with greater connectivity.</li>
</ul>
<p>Next, let’s analyze the service frequency by examining the timing intervals between trips during different parts of the day. It will help us understand peak and off-peak operational strategies, which are crucial for managing commuter flow efficiently. Let’s calculate and visualize these intervals:</p>
<pre><code class="language-python"># converting stop_times 'arrival_time' from string to datetime.time for easier manipulation
import datetime as dt

# function to convert time string to datetime.time
def convert_to_time(time_str):
    try:
        return dt.datetime.strptime(time_str, '%H:%M:%S').time()
    except ValueError:
        # Handle cases where the hour might be greater than 23 (e.g., 24:00:00 or 25:00:00)
        hour, minute, second = map(int, time_str.split(':'))
        return dt.time(hour % 24, minute, second)

stop_times['arrival_time_dt'] = stop_times['arrival_time'].apply(convert_to_time)

# calculate the difference in arrival times for subsequent trips at each stop
stop_times_sorted = stop_times.sort_values(by=['stop_id', 'arrival_time_dt'])
stop_times_sorted['next_arrival_time'] = stop_times_sorted.groupby('stop_id')['arrival_time_dt'].shift(-1)

# function to calculate the difference in minutes between two times
def time_difference(time1, time2):
    if pd.isna(time1) or pd.isna(time2):
        return None
    full_date_time1 = dt.datetime.combine(dt.date.today(), time1)
    full_date_time2 = dt.datetime.combine(dt.date.today(), time2)
    return (full_date_time2 - full_date_time1).seconds / 60

stop_times_sorted['interval_minutes'] = stop_times_sorted.apply(lambda row: time_difference(row['arrival_time_dt'], row['next_arrival_time']), axis=1)

# drop NaN values from intervals (last trip of the day)
stop_times_intervals = stop_times_sorted.dropna(subset=['interval_minutes'])

# average intervals by time of day (morning, afternoon, evening)
def part_of_day(time):
    if time &lt; dt.time(12, 0):
        return 'Morning'
    elif time &lt; dt.time(17, 0):
        return 'Afternoon'
    else:
        return 'Evening'

stop_times_intervals['part_of_day'] = stop_times_intervals['arrival_time_dt'].apply(part_of_day)
average_intervals = stop_times_intervals.groupby('part_of_day')['interval_minutes'].mean().reset_index()

plt.figure(figsize=(8, 6))
sns.barplot(x='part_of_day', y='interval_minutes', data=average_intervals, order=['Morning', 'Afternoon', 'Evening'], palette='mako')
plt.title('Average Interval Between Trips by Part of Day')
plt.xlabel('Part of Day')
plt.ylabel('Average Interval (minutes)')
plt.grid(True)
plt.show()</code></pre>
<figure class="wp-block-image aligncenter size-full is-resized"><img alt="Average Interval Between Trips by Part of Day" class="wp-image-23458" data-attachment-id="23458" data-comments-opened="1" data-image-caption="" data-image-description="" data-image-meta='{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}' data-image-title="delhi-metro-5" data-large-file="https://i0.wp.com/my-ai-portfolio.com/wp-content/uploads/2024/05/delhi-metro-5.png?fit=691%2C547&amp;ssl=1" data-medium-file="https://i0.wp.com/my-ai-portfolio.com/wp-content/uploads/2024/05/delhi-metro-5.png?fit=300%2C237&amp;ssl=1" data-orig-file="https://i0.wp.com/my-ai-portfolio.com/wp-content/uploads/2024/05/delhi-metro-5.png?fit=691%2C547&amp;ssl=1" data-orig-size="691,547" data-permalink="https://my-ai-portfolio.com/2024/05/13/metro-operations-optimization-using-python/delhi-metro-5/" data-recalc-dims="1" decoding="async" height="547" loading="lazy" sizes="auto, (max-width: 691px) 100vw, 691px" src="https://i0.wp.com/my-ai-portfolio.com/wp-content/uploads/2024/05/delhi-metro-5.png?resize=691%2C547&amp;ssl=1" srcset="https://i0.wp.com/my-ai-portfolio.com/wp-content/uploads/2024/05/delhi-metro-5.png?w=691&amp;ssl=1 691w, https://i0.wp.com/my-ai-portfolio.com/wp-content/uploads/2024/05/delhi-metro-5.png?resize=300%2C237&amp;ssl=1 300w" style="width:676px;height:auto" width="691"/></figure>
<p>The bar chart above displays the average interval between trips on the Delhi Metro during different parts of the day: morning, afternoon, and evening. This data provides insight into the service frequency and how it is adjusted based on the expected demand throughout the day. Key findings are:</p>
<ul class="wp-block-list">
<li><strong>Morning</strong>: Shorter intervals between trips are observed in the morning hours, which likely corresponds to the morning rush hour when commuters are heading to work or school.</li>
<li><strong>Afternoon</strong>: The intervals increase slightly during the afternoon, which may indicate a reduction in demand after the morning peak.</li>
<li><strong>Evening</strong>: In the evening, intervals decrease again, likely to accommodate the evening rush hour as people return home.</li>
</ul>
<p>Now, let’s calculate the number of trips and the available capacity per time interval. It will give us a basic understanding of how service levels vary throughout the day. We’ll classify the intervals as:</p>
<ul class="wp-block-list">
<li><strong>Early Morning</strong>: Before 6 AM</li>
<li><strong>Morning Peak</strong>: 6 AM to 10 AM</li>
<li><strong>Midday</strong>: 10 AM to 4 PM</li>
<li><strong>Evening Peak</strong>: 4 PM to 8 PM</li>
<li><strong>Late Evening</strong>: After 8 PM</li>
</ul>
<p>Let’s calculate the supply in terms of trips during these time intervals using the stop_times data:</p>
<pre><code class="language-python"># define time intervals for classification
def classify_time_interval(time):
    if time &lt; dt.time(6, 0):
        return 'Early Morning'
    elif time &lt; dt.time(10, 0):
        return 'Morning Peak'
    elif time &lt; dt.time(16, 0):
        return 'Midday'
    elif time &lt; dt.time(20, 0):
        return 'Evening Peak'
    else:
        return 'Late Evening'

# apply time interval classification
stop_times['time_interval'] = stop_times['arrival_time_dt'].apply(classify_time_interval)

# count the number of trips per time interval
trips_per_interval = stop_times.groupby('time_interval')['trip_id'].nunique().reset_index()
trips_per_interval = trips_per_interval.rename(columns={'trip_id': 'number_of_trips'})

# sorting the dataframe
ordered_intervals = ['Early Morning', 'Morning Peak', 'Midday', 'Evening Peak', 'Late Evening']
trips_per_interval['time_interval'] = pd.Categorical(trips_per_interval['time_interval'], categories=ordered_intervals, ordered=True)
trips_per_interval = trips_per_interval.sort_values('time_interval')

# plotting the number of trips per time interval
plt.figure(figsize=(10, 6))
sns.barplot(x='time_interval', y='number_of_trips', data=trips_per_interval, palette='Set2')
plt.title('Number of Trips per Time Interval')
plt.xlabel('Time Interval')
plt.ylabel('Number of Trips')
plt.grid(True)
plt.show()</code></pre>
<figure class="wp-block-image aligncenter size-full is-resized"><img alt="Metro Operations Optimization: Number of Trips per Time Interval" class="wp-image-23461" data-attachment-id="23461" data-comments-opened="1" data-image-caption="" data-image-description="" data-image-meta='{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}' data-image-title="delhi-metro-6" data-large-file="https://i0.wp.com/my-ai-portfolio.com/wp-content/uploads/2024/05/delhi-metro-6.png?fit=859%2C547&amp;ssl=1" data-medium-file="https://i0.wp.com/my-ai-portfolio.com/wp-content/uploads/2024/05/delhi-metro-6.png?fit=300%2C191&amp;ssl=1" data-orig-file="https://i0.wp.com/my-ai-portfolio.com/wp-content/uploads/2024/05/delhi-metro-6.png?fit=859%2C547&amp;ssl=1" data-orig-size="859,547" data-permalink="https://my-ai-portfolio.com/2024/05/13/metro-operations-optimization-using-python/delhi-metro-6/" data-recalc-dims="1" decoding="async" height="547" loading="lazy" sizes="auto, (max-width: 859px) 100vw, 859px" src="https://i0.wp.com/my-ai-portfolio.com/wp-content/uploads/2024/05/delhi-metro-6.png?resize=859%2C547&amp;ssl=1" srcset="https://i0.wp.com/my-ai-portfolio.com/wp-content/uploads/2024/05/delhi-metro-6.png?w=859&amp;ssl=1 859w, https://i0.wp.com/my-ai-portfolio.com/wp-content/uploads/2024/05/delhi-metro-6.png?resize=300%2C191&amp;ssl=1 300w, https://i0.wp.com/my-ai-portfolio.com/wp-content/uploads/2024/05/delhi-metro-6.png?resize=768%2C489&amp;ssl=1 768w" style="width:722px;height:auto" width="859"/></figure>
<p>The bar chart displays the number of trips scheduled for each time interval in the Delhi Metro system. From this visualization, we can observe the following:</p>
<ol class="wp-block-list">
<li><strong>Early Morning:</strong> There is a relatively low number of trips, indicating less demand or fewer scheduled services during these hours.</li>
<li><strong>Morning Peak:</strong> There is a significant increase in the number of trips compared to the early morning, likely due to morning commute hours as people travel to work or school.</li>
<li><strong>Midday:</strong> The number of trips remains high, perhaps sustaining the morning rush or due to other midday travel needs.</li>
<li><strong>Evening Peak:</strong> This period sees a slight decrease compared to midday but remains one of the busier times, probably reflecting the evening commute.</li>
<li><strong>Late Evening:</strong> The number of trips drops again, but remains higher than in the early morning, likely catering to people returning home late or involved in evening activities.</li>
</ol>
<h4 class="wp-block-heading">Optimizing Operations to Reduce Overcrowding in Metro</h4>
<p>Now, as we have analyzed the dataset, let’s build a data-driven strategy to reduce the overcrowding in Delhi Metro. To reduce the overcrowding in the Delhi Metro, we can adjust train frequencies based on time interval analysis.</p>
<p>We’ve already analyzed the number of trips during different time intervals, which provides a clear picture of the existing supply. By cross-referencing this data with inferred demand (e.g., crowd levels observed at platforms, as actual passenger data isn’t available), adjustments can be made. For instance, if certain time intervals like the morning or evening peaks show signs of overcrowding, increasing the number of trips or adjusting the timing of the trips could help alleviate this issue.</p>
<p>Let’s start with refining the frequencies of trains during peak and off-peak hours based on the trip frequency analysis we performed earlier. I’ll create a hypothetical scenario where we adjust the frequencies during these times based on assumed passenger loads. An assumption here is that morning and evening peaks need a 20% increase in service, while midday and late evening might handle a 10% reduction without impacting passenger service negatively.</p>
<p>Let’s calculate and visualize these adjustments:</p>
<pre><code class="language-python"># adjusting frequencies based on hypothetical scenario
adjusted_trips_per_interval = trips_per_interval.copy()
adjustment_factors = {'Morning Peak': 1.20, 'Evening Peak': 1.20, 'Midday': 0.90, 'Early Morning': 1.0, 'Late Evening': 0.90}

# apply the adjustments
adjusted_trips_per_interval['adjusted_number_of_trips'] = adjusted_trips_per_interval.apply(
    lambda row: int(row['number_of_trips'] * adjustment_factors[row['time_interval']]), axis=1)

# plotting original vs adjusted number of trips per time interval
plt.figure(figsize=(12, 6))
bar_width = 0.35
r1 = range(len(adjusted_trips_per_interval))
r2 = [x + bar_width for x in r1]

plt.bar(r1, adjusted_trips_per_interval['number_of_trips'], color='blue', width=bar_width, edgecolor='grey', label='Original')
plt.bar(r2, adjusted_trips_per_interval['adjusted_number_of_trips'], color='cyan', width=bar_width, edgecolor='grey', label='Adjusted')

plt.xlabel('Time Interval', fontweight='bold')
plt.ylabel('Number of Trips', fontweight='bold')
plt.xticks([r + bar_width/2 for r in range(len(adjusted_trips_per_interval))], adjusted_trips_per_interval['time_interval'])
plt.title('Original vs Adjusted Number of Trips per Time Interval')
plt.legend()

plt.show()</code></pre>
<figure class="wp-block-image aligncenter size-full"><img alt="Original vs Adjusted Number of Trips per Time Interval" class="wp-image-23463" data-attachment-id="23463" data-comments-opened="1" data-image-caption="" data-image-description="" data-image-meta='{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}' data-image-title="delhi-metro-7" data-large-file="https://i0.wp.com/my-ai-portfolio.com/wp-content/uploads/2024/05/delhi-metro-7.png?fit=1014%2C547&amp;ssl=1" data-medium-file="https://i0.wp.com/my-ai-portfolio.com/wp-content/uploads/2024/05/delhi-metro-7.png?fit=300%2C162&amp;ssl=1" data-orig-file="https://i0.wp.com/my-ai-portfolio.com/wp-content/uploads/2024/05/delhi-metro-7.png?fit=1014%2C547&amp;ssl=1" data-orig-size="1014,547" data-permalink="https://my-ai-portfolio.com/2024/05/13/metro-operations-optimization-using-python/delhi-metro-7/" data-recalc-dims="1" decoding="async" height="547" loading="lazy" sizes="auto, (max-width: 1014px) 100vw, 1014px" src="https://i0.wp.com/my-ai-portfolio.com/wp-content/uploads/2024/05/delhi-metro-7.png?resize=1014%2C547&amp;ssl=1" srcset="https://i0.wp.com/my-ai-portfolio.com/wp-content/uploads/2024/05/delhi-metro-7.png?w=1014&amp;ssl=1 1014w, https://i0.wp.com/my-ai-portfolio.com/wp-content/uploads/2024/05/delhi-metro-7.png?resize=300%2C162&amp;ssl=1 300w, https://i0.wp.com/my-ai-portfolio.com/wp-content/uploads/2024/05/delhi-metro-7.png?resize=768%2C414&amp;ssl=1 768w" width="1014"/></figure>
<p>The bar chart illustrates the original versus adjusted number of trips per time interval for the Delhi Metro, based on our hypothetical adjustments to better align service levels with inferred demand:</p>
<ul class="wp-block-list">
<li><strong>Morning and Evening Peaks</strong>: We increased the number of trips by 20%, anticipating higher demand during these hours. This adjustment aims to reduce overcrowding and improve passenger comfort and service reliability.</li>
<li><strong>Midday and Late Evening</strong>: We decreased the trips by 10%, assuming that the demand drops during these times, allowing for more efficient use of resources without significantly impacting service quality.</li>
</ul>
<p>By implementing these adjustments, Delhi Metro can potentially improve operational efficiency and customer satisfaction, especially during peak hours.</p>
<h3 class="wp-block-heading">Summary</h3>
<p>Metro Operations Optimization refers to the systematic process of enhancing the efficiency, reliability, and effectiveness of Metro services through various data-driven techniques and operational adjustments. Our approach to optimizing metro operations showcases how analyzing existing data can guide decisions in real-time scheduling adjustments, even in the absence of explicit passenger count data.</p>
<!-- CONTENT END 1 -->
</article>
<!-- Navigation Bottom -->
<div style="margin-top: 4rem; padding-top: 2rem; border-top: 1px solid #E5E7EB; display: flex; justify-content: space-between;">
<a href="elections-ad-spending-analysis-with-python.html" style="text-decoration: none; color: var(--primary-color); font-weight: 600;">←
                        Previous Article</a>
<a href="../articles.html" style="text-decoration: none; color: var(--text-muted); font-weight: 500;">All Articles</a>
<a href="electric-vehicles-market-size-analysis-using-python.html" style="text-decoration: none; color: var(--primary-color); font-weight: 600;">Next
                        Article →</a>
</div>
</div>
<!-- Right: Sticky Sidebar -->
<aside class="sidebar-area">
<div class="sticky-sidebar-content">
<!-- Search Widget (Optional) -->
<!-- <div class="sidebar-widget"> ... </div> -->
<!-- Sidebar Ad -->
<div class="ad-unit ad-sidebar-vertical">
<span>Advertisement (Vertical)</span>
</div>
<!-- Popular Posts -->
<div class="sidebar-widget">
<h3 class="widget-title">Popular Articles</h3>
<ul class="popular-posts-list">
<li><a href="#">Building AI Agents with LangChain</a></li>
<li><a href="#">Optimizing PyTorch Loops</a></li>
<li><a href="#">Data Structures for ML Engineers</a></li>
</ul>
</div>
</div>
</aside>
</div>
</main>
<!-- Footer -->
<footer class="main-footer">
<div class="container">
<div class="footer-content">
<p>© 2025 Kishna Kushwaha. All rights reserved.</p>
<div class="footer-links">
<a href="#">Privacy Policy</a>
<a href="#">Terms of Service</a>
</div>
</div>
</div>
<a aria-label="Go to top" class="go-top-btn" href="#"><i class="fas fa-arrow-up"></i></a>
</footer>
<script src="../js/script.js"></script>
<!-- Highlight.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>
<script>hljs.highlightAll();</script>
<div class="search-overlay" id="search-overlay">
<div class="search-container">
<button class="search-close-btn" id="search-close">×</button>
<input autocomplete="off" id="search-input" placeholder="Search articles, projects..." type="text"/>
<div class="search-results" id="search-results"></div>
</div>
</div><script src="../js/search.js"></script></body>
</html>